Description: fix buffer overflow
 based on 101_fix_buf_overflow from Leo Iannacone <l3on@ubuntu.com> 
Author: Jörg Frings-Fürst <debian@jff-webhosting.net>
Bug: TSOL buffer overflow
Bug-ubuntu: https://bugs.launchpad.net/ubuntu/+source/ipmitool/+bug/633054
Forwarded: https://sourceforge.net/p/ipmitool/patches/100/
Last-Update: 2014-05-18
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
Index: trunk/lib/ipmi_tsol.c
===================================================================
--- trunk.orig/lib/ipmi_tsol.c	2014-05-18 19:36:46.059192272 +0200
+++ trunk/lib/ipmi_tsol.c	2014-05-18 19:37:36.028189246 +0200
@@ -385,7 +385,7 @@
 	socklen_t mylen;
 	char *recvip = NULL;
 	char out_buff[IPMI_BUF_SIZE * 8], in_buff[IPMI_BUF_SIZE];
-	char buff[IPMI_BUF_SIZE + 4];
+	char buff[IPMI_BUF_SIZE * 8 + 4];
 	int fd_socket, result, i;
 	int out_buff_fill, in_buff_fill;
 	int ip1, ip2, ip3, ip4;
